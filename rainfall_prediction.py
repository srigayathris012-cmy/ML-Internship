# -*- coding: utf-8 -*-
"""Rainfall prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-jMX1qDNc9l0g8dUpLIUIthpcC2-B4rP
"""

import pandas as pd
import numpy as np
from sklearn.linear_model import LogisticRegression

data = pd.read_csv('/content/drive/MyDrive/ML project files/Rainfall.csv')  #load dataset
print(data)

data.isnull().sum()

# Now select the columns after cleaning
rain_data = data[['temparature', 'windspeed','rainfall']]
print(rain_data)

# Drop rows with any missing values from the relevant columns before splitting
rain_data_cleaned = rain_data.dropna(subset=['temparature', 'windspeed', 'rainfall'])
X = rain_data_cleaned[['temparature','windspeed']]
y = rain_data_cleaned['rainfall']
print(X)

#  Split into train and test (80% train, 20% test)
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

#Encode the dependent variable (Rainfall: Yes/No -> 1/0)
label_encoder = LabelEncoder()
rain_data['rainfall'] = label_encoder.fit_transform(rain_data['rainfall'])  # Yes=1, No=0
print(rain_data)

# Standardize features
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

model = LogisticRegression()
model.fit(X_train, y_train)

# Predict on test data
y_pred = model.predict(X_test)
y_pred_label = label_encoder.inverse_transform(y_pred)

#  Example: Predict for new data
# Input: WindSpeed, Temperature
new_data = [[5, 50]]  # Example values
new_data_scaled = scaler.transform(new_data)
new_pred = model.predict(new_data_scaled)
new_pred_label = label_encoder.inverse_transform(new_pred)
new_final_output = 'Rainfall' if new_pred_label[0]=='Yes' else 'No Rainfall'

print("Prediction for new data:", new_final_output)